(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{221:function(a,e,t){a.exports=t.p+"assets/img/2743275-bb3b5f78f6cb1ee3.9beaeb58.png"},401:function(a,e,t){"use strict";t.r(e);var s=t(0),i=Object(s.a)({},(function(){var a=this,e=a.$createElement,s=a._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"kibana使用高德地图"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kibana使用高德地图","aria-hidden":"true"}},[a._v("#")]),a._v(" Kibana使用高德地图")]),a._v(" "),s("h3",{attrs:{id:"说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#说明","aria-hidden":"true"}},[a._v("#")]),a._v(" 说明")]),a._v(" "),s("ul",[s("li",[a._v("目前"),s("code",[a._v("Kibana")]),a._v("默认自带的地图全部是英文，更换高德地图对地图汉化")])]),a._v(" "),s("h3",{attrs:{id:"一、修改配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、修改配置","aria-hidden":"true"}},[a._v("#")]),a._v(" 一、修改配置")]),a._v(" "),s("p",[a._v("1、 编辑"),s("code",[a._v("kibana")]),a._v("配置文件"),s("code",[a._v("kibana.yml")]),a._v("，最后面添加")]),a._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("tilemap.url")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'http://webrd02.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=7&x={x}&y={y}&z={z}'")]),a._v("\n")])])]),s("h5",{attrs:{id:"删除kibana目录下的optimize-bundles文件夹后，重启，如果bundles目录没有新文件生成，注意权限哈！"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#删除kibana目录下的optimize-bundles文件夹后，重启，如果bundles目录没有新文件生成，注意权限哈！","aria-hidden":"true"}},[a._v("#")]),a._v(" 删除kibana目录下的"),s("code",[a._v("optimize/bundles")]),a._v("文件夹后，重启，如果bundles目录没有新文件生成，注意权限哈！")]),a._v(" "),s("p",[a._v("2、 在logstash服务器下载IP地址归类查询库")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# wget http://geolite.maxmind.com/download/geoip/database/GeoLite2-City.mmdb.gz")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# gunzip GeoLite2-City.mmdb.gz")]),a._v("\n")])])]),s("p",[a._v("3、编辑logstash配置文件")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('input {\n    stdin {}\n}\n\n filter {\n    geoip {\n        source => "message"\n        target => "geoip"\n        database => "/usr/local/logstash-5.1.1/config/GeoLite2-City.mmdb"\n        add_field => ["[geoip][coordinates]","%{[geoip][longitude]}"]\n        add_field => ["[geoip][coordinates]","%{[geoip][latitude]}"]\n     }\n }\n\n output {\n        elasticsearch {\n            hosts => "172.16.11.199"\n            index => "logstash-map-%{+YYYY.MM.dd}"\n        }\n}\n\n')])])]),s("h4",{attrs:{id:"配置解释"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置解释","aria-hidden":"true"}},[a._v("#")]),a._v(" 配置解释")]),a._v(" "),s("p",[s("strong",[a._v("这里为了测试，数据通过终端手动输入")])]),a._v(" "),s("ul",[s("li",[s("code",[a._v("geoip")]),a._v(": IP查询插件")]),a._v(" "),s("li",[s("code",[a._v("source")]),a._v(": 需要通过geoip插件处理的field，一般为ip，这里因为通过控制台手动输入的是ip所以直接填message，生成环境中如果查询nginx访问用户，需先将客户端ip过滤出来，然后这里填clientip即可")]),a._v(" "),s("li",[s("code",[a._v("target")]),a._v(": 解析后的Geoip地址数据，应该存放在哪一个字段中，默认是geoip这个字段")]),a._v(" "),s("li",[s("code",[a._v("database")]),a._v(": 指定下载的数据库文件")]),a._v(" "),s("li",[s("code",[a._v("add_field")]),a._v(": 这里两行是添加经纬度，地图中地区显示是根据经纬度来识别")])]),a._v(" "),s("h4",{attrs:{id:"效果图"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#效果图","aria-hidden":"true"}},[a._v("#")]),a._v(" 效果图")]),a._v(" "),s("p",[s("img",{attrs:{src:t(221),alt:""}})])])}),[],!1,null,null,null);e.default=i.exports}}]);